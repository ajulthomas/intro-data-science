---
title: "Final Assignment, Task 3"
author: "Tamzid Ibrahim"
date: "2023-11-2"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Task 3: Data-Driven Modelling: 	(15 marks)

1. Based on the covid19_data dataframe, that you have wrangled and used in the previous tasks, create a separate dataframe named "cor_data" with the data of these variables (CumCases, CumTests, Population, GDP, GDPCapita) variables.

    [Hint: you can use select function on the covid19_data dataframe]

```{r}

library(GGally)

cor_data <- covid19_data %>%
  select(CumCases, CumTests, Population, GDP, GDPCapita)

```

2. Compute the correlation matrix between the variables of the “cor_data” and visualise this correlation matrix.

```{r}
# R automatically adds a grouping column, with the variable country. 
cor_data = cor_data[-1] # This column will be deleted as it is a non-numeric column and it is not required

# From the GGally library we use the cor function on cor data, it will show the correlation matrix between each variables
cor(cor_data) 

# The same correlation matrix between individual variables can be visually shown by using ggcorr. 
ggcorr(cor_data)

```

3. visualize the distribution of the cumulative cases in the cor_data with and without changing the scale of the x axis to log transformation.

```{r}
# Creating a histogram without changing the scale of the x-axis to log transformation. 
cor_data %>% 
  ggplot(aes(x = CumCases)) + 
  geom_histogram(fill = "#4C72B0", color = "#2B485D", bins = 30) +
  theme_minimal() +
  labs(title = "Distribution of Cumulative Cases",
       x = "Cumulative Cases",
       y = "Frequency") +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        axis.line = element_line(colour = "black"),
        text = element_text(color = "#2B485D"))  

# Creating a histogram without changing the scale of the x-axis to log transformation. 
cor_data %>% 
  ggplot(aes(x = CumCases)) + 
  geom_histogram(fill = "#4C72B0", color = "#2B485D", bins = 30) +
  scale_x_log10() +  # Log transformation on x-axis
  theme_minimal() +
  labs(title = "Distribution of Cumulative Cases",
       x = "Log(Cumulative Cases)",  # Update x-axis label
       y = "Frequency") +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        axis.line = element_line(colour = "black"),
        text = element_text(color = "#2B485D"))



```

4. Divide the cor_data into training and testing, where training data represent 65% of the number of rows.

```{r}
# Dividing the cor_data into training and testing data

# The training data will represent 65% of the number of rows. 

index <- sample(c(T,F), nrow(cor_data), replace = T, prob = c(.65, .35))


data_training <- cor_data[index, ]

data_testing <- cor_data[!index, ]

nrow(data_testing)  # There should be around 65% of the rows
nrow(data_training) # There should be around 25% of the rows


```

5. Train a linear regression model to predict cumulative cases from the GDP of the countries. Then, evaluate this model on the test data and print the root mean square error value.

```{r}

model_GDP <- lm(CumCases ~ GDP, data = data_training)

predicted <- 
  predict(model_GDP, data_testing)

library(Metrics)

actual <- 
  data_testing$CumCases

rmse(actual, predicted)

sqrt(mean((predicted-actual)^2))

```

6. Train another linear regression model to predict cumulative cases from all the other variables. Then, evaluate this model on the test data and print the root mean square error value.

```{r}
all_model <- lm(CumCases ~ ., data = data_training)

all_predicted <- 
  predict(all_model, data_testing)

all_actual <- 
  data_testing$CumCases

rmse(all_actual, all_predicted)

sqrt(mean((all_predicted-all_actual)^2))



```

7. Interpret the two models and write a small report of highlighting the differences between using the two models. For example, in which cases we should use the first model and in which cases the second one is better to use.

**Interpretation goes below here**:
- 
- 
- 
-

----

**Task 3 final Report**: Highlight the output (Description, graphs and statistics) that have been generated by writing and running the code of the above components. 

----

*** 